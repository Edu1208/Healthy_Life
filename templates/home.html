{% extends "base.html" %}
{% block title %}Inicio - Healthy Life{% endblock %}
{% block content %}
<div class="container py-4">
  <!-- Hero Section -->
  <div class="row align-items-center mb-5">
    <div class="col-lg-6">
      <h1 class="display-4 fw-bold text-success mb-3">
        Bienvenido a Healthy Life
      </h1>
      <p class="lead text-muted mb-4">
        Tu compañero perfecto para alcanzar tus metas fitness. Crea rutinas personalizadas, 
        sigue tu progreso y mantén la motivación con nuestro sistema de rachas.
      </p>
      <div class="d-flex gap-3">
        <a href="{{ url_for('nuevo') }}" class="btn btn-success btn-lg">
          <i class="bi bi-plus-circle me-2"></i>Crear Rutina
        </a>
        <a href="{{ url_for('historial_rutinas') }}" class="btn btn-outline-success btn-lg">
          <i class="bi bi-clock-history me-2"></i>Ver Historial
        </a>
      </div>
    </div>
    <div class="col-lg-6 text-center">
      <img src="{{ url_for('static', filename='img/fitness-hero.png') }}" 
           alt="Fitness" class="img-fluid" 
           onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZjhmOWZhIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxOCIgZmlsbD0jOTk5IHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIwLjNlbSI+SGVhbHRoeSBMaWZlPC90ZXh0Pjwvc3ZnPg=='">
    </div>
  </div>

  <!-- Estadísticas Rápidas -->
  <div class="row mb-5">
    <div class="col-md-3">
      <div class="card text-center border-0 shadow-sm">
        <div class="card-body">
          <i class="bi bi-fire display-4 text-warning mb-3"></i>
          <h3 id="rachaActual" class="text-warning">0</h3>
          <p class="text-muted mb-0">Días de Racha</p>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card text-center border-0 shadow-sm">
        <div class="card-body">
          <i class="bi bi-dumbbell display-4 text-primary mb-3"></i>
          <h3 id="totalRutinas" class="text-primary">0</h3>
          <p class="text-muted mb-0">Rutinas Creadas</p>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card text-center border-0 shadow-sm">
        <div class="card-body">
          <i class="bi bi-check-circle display-4 text-success mb-3"></i>
          <h3 id="rutinasCompletadas" class="text-success">0</h3>
          <p class="text-muted mb-0">Completadas</p>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card text-center border-0 shadow-sm">
        <div class="card-body">
          <i class="bi bi-clock display-4 text-info mb-3"></i>
          <h3 id="minutosTotales" class="text-info">0</h3>
          <p class="text-muted mb-0">Minutos Totales</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Acciones Rápidas -->
  <div class="row">
    <div class="col-md-4 mb-4">
      <div class="card h-100 border-0 shadow-sm">
        <div class="card-body text-center">
          <i class="bi bi-plus-circle display-1 text-success mb-3"></i>
          <h4>Crear Rutina</h4>
          <p class="text-muted">Diseña tu plan de entrenamiento personalizado</p>
          <a href="{{ url_for('nuevo') }}" class="btn btn-success">Comenzar</a>
        </div>
      </div>
    </div>
    <div class="col-md-4 mb-4">
      <div class="card h-100 border-0 shadow-sm">
        <div class="card-body text-center">
          <i class="bi bi-fire display-1 text-warning mb-3"></i>
          <h4>Seguir Racha</h4>
          <p class="text-muted">Mantén tu consistencia y logra nuevos records</p>
          <a href="{{ url_for('racha') }}" class="btn btn-warning text-white">Ver Racha</a>
        </div>
      </div>
    </div>
    <div class="col-md-4 mb-4">
      <div class="card h-100 border-0 shadow-sm">
        <div class="card-body text-center">
          <i class="bi bi-journal-text display-1 text-primary mb-3"></i>
          <h4>Mis Notas</h4>
          <p class="text-muted">Organiza tus rutinas y anota tu progreso</p>
          <a href="{{ url_for('notas') }}" class="btn btn-primary">Ver Notas</a>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
  cargarEstadisticas();
});

function cargarEstadisticas() {
  // Cargar datos de rutinas
  fetch('/historial-rutinas-data')
    .then(response => response.json())
    .then(data => {
      if (data.success) {
        const rutinas = data.rutinas;
        document.getElementById('totalRutinas').textContent = rutinas.length;
        document.getElementById('minutosTotales').textContent = 
          rutinas.reduce((sum, r) => sum + (parseInt(r.duracion) || 0), 0);
      }
    })
    .catch(error => {
      console.error('Error al cargar estadísticas:', error);
    });

  // Cargar datos de racha desde localStorage como fallback
  const datosRacha = JSON.parse(localStorage.getItem('racha_healthy_life')) || { diasConsecutivos: 0 };
  document.getElementById('rachaActual').textContent = datosRacha.diasConsecutivos;
}
</script>
{% endblock %}
